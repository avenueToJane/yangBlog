<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>事件墙</title>
    <link th:href="@{/admin/css/bootstrap.min.css?v=3.3.6}" rel="stylesheet"/>
    <link th:href="@{/admin/css/font-awesome.css?v=4.4.0}" rel="stylesheet"/>
    <link th:href="@{/admin/css/animate.css}" rel="stylesheet"/>
    <link th:href="@{/admin/css/style.css?v=4.1.0}" rel="stylesheet"/>
    <!-- Sweet Alert -->
    <link th:href="@{/admin/login/css/plugins/sweetalert/sweetalert.css}" rel="stylesheet"/>
</head>
<body class="gray-bg">
    <div class="row">
        <div class="col-sm-12">
            <div class="wrapper wrapper-content animated fadeInUp">
                <ul class="notes" th:each="summary:${list}">
                    <li>
                        <div>
                        
                            <small th:text="${summary.createTime}"></small>
                           
                            <h4 th:text="${summary.title}"></h4>
                            <p th:text="${summary.content}"></p>                                                                         
                            <a href="javascript:void()" th:onclick="'delSummary('+${summary.id}+');'"><i class="fa fa-trash-o fa-2x"></i></a>                                 
                       </div>
                         <small><a href="javascript:void()" th:onclick="'eitSummary('+${summary.id}+');'"><i class="fa fa-edit fa-2x"></i></a></small>
                    </li>                                               
                </ul>
            </div>
        </div>
    </div>          
                            <!-- 模态窗口 -->
                        <div class="modal inmodal" id="myModal" tabindex="-1" role="dialog" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content animated bounceInRight">
                                    <div class="modal-header">
                                        
                                        <h4 class="modal-title">事件主题</h4>
                                       
                                        </div>
                                        <label>事件内容</label>      
                                        <input type="hidden" id="hidId"></input> <!-- 隐藏域 -->                               
                                         <input class="s_content" type="text"  style="width:100%; height:150px;"/>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-white" id="closeModel">关闭</button>
                                            <button type="button" class="btn btn-primary" id="saveSummary">保存</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            

    <!-- 全局js -->
    <script th:src="@{/admin/login/js/jquery.min.js?v=2.1.4}"></script>
    <script th:src="@{/admin/login/js/bootstrap.min.js?v=3.3.6}"></script>

    <!-- 自定义js -->
    <script th:src="@{/admin/login/js/content.js?v=1.0.0}"></script>
    
       <!-- Sweet alert -->
    <script th:src="@{/admin/login/js/plugins/sweetalert/sweetalert.min.js}"></script>
<script type="text/javascript">
/* 关闭模态窗口 */
$('#closeModel').click(function () {
	$("#myModal").hide();
});

/* 保存按钮 */
$('#saveSummary').click(function () {
	var title=$(".modal-title").text();
	var content= $(".s_content").val();
    var id=$("#hidId").val();
	$.post("/admin/summary/saveSummary",
			  {
			    id:id,
			    title:title,
			    content,content
			  },
			  function(result){							 
				  $("#myModal").hide();//关闭窗口	
				  window.location.reload();
			});    	
	
	
});
    /*<![CDATA[*/
    
    function delSummary(id) {
    	swal({
            title: "您确定要删除这条事件吗",
            text: "删除后将无法恢复，请谨慎操作！",
            type: "warning",
            showCancelButton: true,
            confirmButtonColor: "#DD6B55",
            confirmButtonText: "删除",
            closeOnConfirm: false
        }, function () {
        	$.post("/admin/summary/delete",
        			  {
        			    id:id
        			  },
        			  function(result){
        				  if(result && result.success){
        					  swal("删除成功！", "您已经永久删除了这条事件。", "success");
        					  window.location.reload();
                          } else {
                        	  swal("删除失败！", "", "fail");
                          }       				 
        			  });
            
        });
    }
    
    function eitSummary(id) {
    	$.post("/admin/summary/detail",
  			  {
  			    id:id
  			  },
  			  function(result){							 
 				//渲染模态框
 				$(".modal-title").text(result.payload.title)
 				$(".s_content").val(result.payload.content)
 				$("#hidId").val(result.payload.id)
  				$("#myModal").show();				              
  			});    			 
    }
    /*]]>*/
</script>
</body>
</html>
